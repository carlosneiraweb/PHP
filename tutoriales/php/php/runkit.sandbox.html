<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>La Clase Runkit Sandbox -- M&aacute;quina Virtual de PHP</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ref.runkit.html">Funciones runkit</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="runkit.sandbox-parent.html">Runkit_Sandbox_Parent</a></div>
 <div class="up"><a href="ref.runkit.html">Funciones runkit</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="runkit.sandbox" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Runkit_Sandbox</h1>
  <p class="verinfo">(PECL runkit &gt;= 0.7.0)</p><p class="refpurpose"><span class="refname">Runkit_Sandbox</span> &mdash; <span class="dc-title">
   La Clase Runkit Sandbox -- Máquina Virtual de PHP
  </span></p>

 </div>
 <div class="refsect1 description" id="refsect1-runkit.sandbox-description">
  <h3 class="title">Descripción</h3>
  
  <p class="para">
   Al instanciar la clase <strong class="classname">Runkit_Sandbox</strong>
   se crea un nuevo hilo con su própio ámbito
   y pila de programa. Al usar un conjunto de opciones pasadas al constructor, este entorno
   puede estar restringido a un subconjunto de lo que el intérprete primario puede hacer y proporciona un
   entorno seguro para ejecutar código proporcionado por el usuario.
  </p>
  
  <blockquote class="note"><p><strong class="note">Nota</strong>: <span class="simpara">Soporte para Entorno de Pruebas (requerido por
<span class="function"><a href="function.runkit-lint.html" class="function">runkit_lint()</a></span>, <span class="function"><a href="function.runkit-lint-file.html" class="function">runkit_lint_file()</a></span>,
y la clase <strong class="classname">Runkit_Sandbox</strong>) está disponible sólo a partir de
PHP 5.1.0 o versiones especialmente parcheadas de PHP 5.0, y requiere que thread
safety sea habilitada.
Vea el archivo <var class="filename">README</var> incluido en el paquete runkit para
más información.</span></p></blockquote>
 </div>

 
 <div class="refsect1 constructor" id="refsect1-runkit.sandbox-constructor">
  <h3 class="title">Constructor</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><span class="type void">void</span></span> <span class="methodname"><strong>Runkit_Sandbox::__construct</strong></span>
    ([ <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code></span>
  ] )</div>

  
  <p class="para rdfs-comment">
   <code class="parameter">options</code> es un array asociativo que contiene
   cualquier combinación de las opciones especiales ini listadas abajo.
  </p>
  
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">safe_mode</code></dt>

     <dd>

      <p class="para">
       Si el script exterior que está instanciando la
       clase <strong class="classname">Runkit_Sandbox</strong>
       se configura con <em>safe_mode = off</em>, safe_mode
       puede ser activado para el entorno del aislamiento de procesos (sandbox). Esta configuración
       no se puede usar para deshabilitar <em>safe_mode</em> cuando ya está
       habilitado en el script exterior.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">safe_mode_gid</code></dt>

     <dd>

      <p class="para">
       Si el script exterior que está instanciando la
       clase <strong class="classname">Runkit_Sandbox</strong>
       se configura con <em>safe_mode_gid = on</em>, safe_mode_gid
       puede ser activado para el entorno del aislamiento de procesos. Esta configuración
       no se puede usar para habilitar <em>safe_mode_gid</em> cuando ya está
       deshabilitado en el script exterior.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">safe_mode_include_dir</code></dt>

     <dd>

      <p class="para">
       Si el script exterior que está instanciando la
       clase <strong class="classname">Runkit_Sandbox</strong>
       se configura con un directorio <em>safe_mode_include_dir</em>,
       un nuevo directorio safe_mode_include_dir puede ser establecido para los entornos del aislamiento
       de procesos bajo es valor definido actualmente. safe_mode_include_dir también puede ser
       limpiado para indicar que la característica de bypass está deshabilitada.
       Si safe_mode_include_dir estaba en blanco en el script exterior, pero safe_mode
       no estaba habilitado, se puede establecer cualquier directorio safe_mode_include_dir arbitrario
       mientras se activa safe_mode.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">open_basedir</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">open_basedir</code> puede ser establecido a cualquier ruta bajo la
       confuguración actual de <em>open_basedir</em>. Si
       <em>open_basedir</em> no está establecido dentro del ámbito global,
       se asume que es el directorio raíz y puede ser establecido a cualquier ubicación.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">allow_url_fopen</code></dt>

     <dd>

      <p class="para">
       Como <code class="parameter">safe_mode</code>, esta configuración sólo puede ser hecha más restrictiva,
       en este caso estableciéndola a <strong><code>FALSE</code></strong> cuando estaba anteriomente establecida a <strong><code>TRUE</code></strong>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">disable_functions</code></dt>

     <dd>

      <p class="para">
       Una lista de funciones separadas por comas a deshabilitar dentro del sub-intérprete del
       aisalmiaento de procesos. Esta lista no necesita contener los nombres de las funciones
       actualmente deshabiltadas, permanecerán deshabiltadas ya estén listadas o no.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">disable_classes</code></dt>

     <dd>

      <p class="para">
       Una lista de clases separadas por comas a deshabilitar dentro del sub-intérprete del
       aisalmiaento de procesos. Esta lista no necesita contener los nombres de las clases
       actualmente deshabiltadas, permanecerán deshabiltadas ya estén listadas o no.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">runkit.superglobal</code></dt>

     <dd>

      <p class="para">
       Una lista de varables separadas por comas a ser tratadas como superglobales dentro del
       sub-intérprete del aislamiaento de procesos. Estas variables serás usadas además de cualquier
       variable definida internamente o a través de la configuración global runkit.superglobal.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">runkit.internal_override</code></dt>

     <dd>

      <p class="para">
       La opción ini <em>runkit.internal_override</em> puede ser deshabilitada
       (pero no rehabilitada) dentro de los aislamientos de procesos.
      </p>
     </dd>

    
   </dl>

  </p>
  
  <div class="example" id="example-591">
   <p><strong>Ejemplo #1 Instanciar un entorno de aislamiento de procesos (sandbox) restringido</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$opciones&nbsp;</span><span style="color: #007700">=&nbsp;array(<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'safe_mode'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">true</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'open_basedir'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'/var/www/users/jdoe/'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'allow_url_fopen'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'false'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'disable_functions'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'exec,shell_exec,passthru,system'</span><span style="color: #007700">,<br />&nbsp;&nbsp;</span><span style="color: #DD0000">'disable_classes'</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">'myAppClass'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sandbox&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Runkit_Sandbox</span><span style="color: #007700">(</span><span style="color: #0000BB">$opciones</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">/*&nbsp;Las&nbsp;configuraciones&nbsp;ini&nbsp;no&nbsp;protegidas&nbsp;pueden&nbsp;establecerse&nbsp;normalmente&nbsp;*/<br /></span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'html_errors'</span><span style="color: #007700">,</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div>

 
 <div class="refsect1 variables" id="refsect1-runkit.sandbox-variables">
  <h3 class="title">Acceder a Variables</h3>
  <p class="para">
   Todas las variables en el ámbito global del entorno del aislamiento de procesos
   son accesibles como propiedades del objeto de aislamiento de procesos.
   Lo primero a tener en cuenta es que a causa de la manera en que se maneja
   la memoria entre estos dos hilos, las variables de objeto y de recurso
   actualmente no se pueden intercambiar entre intérpretes.
   Además, todas las matrices se copian en profundidad y cualquier referencia
   se perderá. Esto también siginifiva que las referencias entre
   intérpretes no son posibles.
  </p>
  
  <div class="example" id="example-592">
   <p><strong>Ejemplo #2 Trabajar con variables en un entorno de aislamiento de procesos (sandbox)</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sandbox&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Runkit_Sandbox</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'bar'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">eval</span><span style="color: #007700">(</span><span style="color: #DD0000">'echo&nbsp;"$foo\n";&nbsp;$bar&nbsp;=&nbsp;$foo&nbsp;.&nbsp;"baz";'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #007700">{</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">bar</span><span style="color: #007700">}</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />if&nbsp;(isset(</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">))&nbsp;unset(</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">eval</span><span style="color: #007700">(</span><span style="color: #DD0000">'var_dump(isset($foo));'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  <p class="para">El resultado del ejemplo sería:</p>
  <div class="example-contents screen">
<div class="cdata"><pre>
bar
barbaz
bool(false)
</pre></div>
  </div>
 </div>

 
 <div class="refsect1 functions" id="refsect1-runkit.sandbox-functions">
  <h3 class="title">Llamar a Funciones de PHP</h3>
  <p class="para">
   Cualquier función definida dentro del entorno de aislamiento de procesos puede ser llamada como
   un método del objeto de aislamiento de procesos. Esto también incluye algunos
   contructores de lenguaje de pseudo-función:  <span class="function"><a href="function.eval.html" class="function">eval()</a></span>,
   <span class="function"><a href="function.include.html" class="function">include</a></span>, <span class="function"><a href="function.include-once.html" class="function">include_once</a></span>,
   <span class="function"><a href="function.require.html" class="function">require</a></span>, <span class="function"><a href="function.require-once.html" class="function">require_once</a></span>,
   <span class="function"><a href="function.echo.html" class="function">echo</a></span>, <span class="function"><a href="function.print.html" class="function">print</a></span>,
   <span class="function"><a href="function.die.html" class="function">die()</a></span>, y <span class="function"><a href="function.exit.html" class="function">exit()</a></span>.
  </p>
  
  <div class="example" id="example-593">
   <p><strong>Ejemplo #3 Llamar a funciones del aislamiento de procesos</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sandbox&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Runkit_Sandbox</span><span style="color: #007700">();<br /><br />echo&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'a'</span><span style="color: #007700">,</span><span style="color: #DD0000">'f'</span><span style="color: #007700">,</span><span style="color: #DD0000">'abc'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  <p class="para">El resultado del ejemplo sería:</p>
  <div class="example-contents screen">
<div class="cdata"><pre>
fbc
</pre></div>
  </div>
  
  <p class="para">
   Cuando se pasan argumentos a una función de aislameinto de procesos, los argumentos
   se toman desde la instancia exterior de PHP. Si se desea pasar
   argumentos desde el ámbito del aislamiento de procesos, asegúrese de acceder a ellos como
   propiedades del objeto de aislamiento de procesos como se ilustra abajo.
  </p>
  
  <div class="example" id="example-594">
   <p><strong>Ejemplo #4 Pasar agumentos a las funciones del aislamiento de procesos</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$sandbox&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Runkit_Sandbox</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'bar'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'baz'</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'a'</span><span style="color: #007700">,</span><span style="color: #0000BB">$foo</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'a'</span><span style="color: #007700">,</span><span style="color: #0000BB">$sandbox</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">foo</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
  <p class="para">El resultado del ejemplo sería:</p>
  <div class="example-contents screen">
<div class="cdata"><pre>
bar
baz
</pre></div>
  </div>
 </div>

 
 <div class="refsect1 settings" id="refsect1-runkit.sandbox-settings">
  <h3 class="title">Cambiar la Configuración del Aislamiento de Procesos</h3>
  <p class="para">
   A partir de la versión 0.5 de runkit, se pueden modificar ciertas configuraciones
   del aislamiento de procesos sobre la marcha usando la sintaxis de ArrayAccess.
   Algunos ajustes, como <code class="parameter">active</code>,
   son de sólo lectura y proporcionan información de estado.
   Otros ajustes, como <code class="parameter">output_handler</code>,
   se pueden establecer y leer como un índice de matriz normal.
   Ajustes futuros puede ser de sólo escritura, sin embargo
   actualmente no existen tales ajustes.
  </p>
  
  <p class="para">
   <table class="doctable table">
    <caption><strong>Configuración del Aislamiento de Procesos / Indicadores de estado</strong></caption>
    
     <thead>
      <tr>
       <th>Configuración</th>
       <th>Tipo</th>
       <th>Propósito</th>
       <th>Predeterminado</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td><em>active</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span> (Sólo Lectura)</td>
       <td>
        <strong><code>TRUE</code></strong> si el Aislamiento de Procesos está aún en un estado usable,
        <strong><code>FALSE</code></strong> si la peticióni está abandonada debido a una
        llamada a die(), exit(), o a causa de una condición
        de error fatal.
       </td>
       <td><strong><code>TRUE</code></strong> (Inicial)</td>
      </tr>

      <tr>
       <td><em>output_handler</em></td>
       <td><span class="type"><a href="language.pseudo-types.html#language.types.callback" class="type Callback">Callback</a></span></td>
       <td>
        Cuando se establece a una llamada de retorno válida, toda la salida generada
        por la instancia del Aislamiento de Procesos será procesada por
        la función nominada.
        Los gestores de salida del Aislamiento de Procesos siguen las misma convenciones
        de llamada que los gestores de salida del lado del sistema.
       </td>
       <td>Ninguno</td>
      </tr>

      <tr>
       <td><em>parent_access</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede usar instancias de la
        clase <strong class="classname">Runkit_Sandbox_Parent</strong>?
        Debe estar habilitado para otras configuraciones de
        <strong class="classname">Runkit_Sandbox_Parent</strong>
        relacionadas para que funcione.
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_read</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede leer variables en su contexto padre?
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_write</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede modificar variables en su contexto padre?
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_eval</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede evaluar código arbitrario en su
        contexto padre? <em class="emphasis">PELIGROSO</em>
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_include</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede incluir archivos de código php en su
        contexto padre? <em class="emphasis">PELIGROSO</em>
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_echo</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede hacer eco de información en su contexto padre
        eefctivamente pasando su propio output_handler?
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_call</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede llamar a funciones en su
        contexto padre?
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_die</em></td>
       <td><span class="type"><a href="language.types.boolean.html" class="type Boolean">Boolean</a></span></td>
       <td>
        ¿El aislamiento de procesos puede eliminar su propio contexto padre? (Y así a sí mismo)
       </td>
       <td><strong><code>FALSE</code></strong></td>
      </tr>

      <tr>
       <td><em>parent_scope</em></td>
       <td><span class="type"><a href="language.types.integer.html" class="type Integer">Integer</a></span></td>
       <td>
        ¿Qué Ámbito tendrá el acceso de las propiedades padre?
        0 == Ámbito global, 1 == Ámbito de llamda,
        2 == Ámbito precediendo al ambito de llamada,
        3 == El ambito antes de este, etc..., etc...
       </td>
       <td><em>0</em> (Global)</td>
      </tr>

      <tr>
       <td><em>parent_scope</em></td>
       <td><span class="type"><a href="language.types.string.html" class="type String">String</a></span></td>
       <td>
        Cuando <em>parent_scope</em> está establecido a
        un valor de cadena, se refiere a un variable de matriz nominada
        en el Ámbito global. Si la variable nominada no
        existe el momento del acceso se creará como un
        array vacío. Si la varible existe pero no es un array,
        se creará un array &quot;falso&quot; que contiene una referencia
        a la variable global nominada.
       </td>
       <td class="empty">&nbsp;</td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 
</div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="ref.runkit.html">Funciones runkit</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="runkit.sandbox-parent.html">Runkit_Sandbox_Parent</a></div>
 <div class="up"><a href="ref.runkit.html">Funciones runkit</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
