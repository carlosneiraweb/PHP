<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Seguridad y modo seguro</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="features.safe-mode.html">Modo seguro</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="features.safe-mode.functions.html">Funciones restringidas/deshabilitadas por el modo seguro</a></div>
 <div class="up"><a href="features.safe-mode.html">Modo seguro</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ini.sect.safe-mode" class="sect1">
  <h2 class="title">Seguridad y modo seguro</h2>
  <p class="para">
   <table class="doctable table">
    <caption><strong>Directivas de configuración de seguridad y modo seguro</strong></caption>
    
     <thead>
      <tr>
       <th>Nombre</th>
       <th>Por defecto</th>
       <th>Cambiable</th>
       <th>Historial de cambios</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td><a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe_mode</a></td>
       <td>&quot;0&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Eliminada en PHP 5.4.0.</td>
      </tr>

      <tr>
       <td><a href="ini.sect.safe-mode.html#ini.safe-mode-gid" class="link">safe_mode_gid</a></td>
       <td>&quot;0&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Eliminada en PHP 5.4.0.</td>
      </tr>

      <tr>
       <td><a href="ini.sect.safe-mode.html#ini.safe-mode-include-dir" class="link">safe_mode_include_dir</a></td>
       <td>NULL</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Eliminada en PHP 5.4.0.</td>
      </tr>

      <tr>
       <td><a href="ini.sect.safe-mode.html#ini.safe-mode-exec-dir" class="link">safe_mode_exec_dir</a></td>
       <td>&quot;&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Eliminada en PHP 5.4.0.</td>
      </tr>

      <tr>
       <td><a href="ini.sect.safe-mode.html#ini.safe-mode-allowed-env-vars" class="link">safe_mode_allowed_env_vars</a></td>
       <td>&quot;PHP_&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Eliminada en PHP 5.4.0.</td>
      </tr>

      <tr>
       <td><a href="ini.sect.safe-mode.html#ini.safe-mode-protected-env-vars" class="link">safe_mode_protected_env_vars</a></td>
       <td>&quot;LD_LIBRARY_PATH&quot;</td>
       <td>PHP_INI_SYSTEM</td>
       <td>Eliminada en PHP 5.4.0.</td>
      </tr>

     </tbody>
    
   </table>

   Para más detalles y definiciones de los modos de
PHP_INI_*, vea <a href="configuration.changes.modes.html" class="xref">D&oacute;nde se puede realizar un ajuste de configuraci&oacute;n</a>.
  </p>
  
  <p class="para">He aquí una breve explicación de
las directivas de configuración.</p>
  
  <p class="para">
   <dl>

    
     <dt id="ini.safe-mode">
      <code class="parameter">safe_mode</code>
      <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
     </dt>

     <dd>

      <p class="para">
       Indica si habilitar el modo seguro de PHP.
       Si PHP se compila con <em>--enable-safe-mode</em>,
       el valor predeterminado será On; si no, será Off.
      </p>
      <div class="warning"><strong class="warning">Advertencia</strong><p class="simpara">Esta característica ha sido declarada
<em class="emphasis">OBSOLETA</em> desde PHP 5.3.0 y <em class="emphasis">ELIMINADA</em>
a partir de PHP 5.4.0.</p></div>
     </dd>

    
    
     <dt id="ini.safe-mode-gid">
      <code class="parameter">safe_mode_gid</code>
      <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
     </dt>

     <dd>

      <p class="para">
       Por defecto, el modo seguro comprueba la comparación de un UID al
       abrir ficheros. Si se quiere suavizar esta comparación a un GID,
       se ha de activar safe_mode_gid.
       Indica si usar la comprobación de <em>UID</em> (<strong><code>FALSE</code></strong>) o de
       <em>GID</em> (<strong><code>TRUE</code></strong>) al acceder a un
       fichero.
      </p>
     </dd>

    
    
     <dt id="ini.safe-mode-include-dir">
      <code class="parameter">safe_mode_include_dir</code>
      <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
     </dt>

     <dd>

      <p class="para">
       Se omiten las comprobaciones de <em>UID</em>/<em>GID</em> cuando
       se incluyen ficheros de este directorio y sus subdirectorios (el directorio
       debe estar también en <a href="ini.core.html#ini.include-path" class="link">include_path</a>
       o debe incluir la ruta completa).
      </p>
      <span class="simpara">
       Esta directiva puede tomar una ruta separada por
       dos puntos (punto y coma en Windows) de forma similar a la directiva
       <a href="ini.core.html#ini.include-path" class="link">include_path</a>,
       en lugar de solamente un único directorio.
      </span>
      <span class="simpara">
       Realmente, la restricción especificada es un prefijo, no un nombre de directorio. 
       Esto significa que &quot;<em>safe_mode_include_dir = /dir/incl</em>&quot; también permite
       el acceso a &quot;<em>/dir/include</em>&quot; y
       &quot;<em>/dir/incls</em>&quot; si existen.  Cuando solamente se quiera
       restringir el acceso al directorio especificado, se ha de finalizarlo con una
       barra. Por ejemplo: &quot;<em>safe_mode_include_dir = /dir/incl/</em>&quot;.
      </span>
      <span class="simpara">
       Si el valor de esta directiva está vacío, no se podrán incluir ficheros con
       <em>UID</em>/<em>GID</em> diferentes.
      </span>
     </dd>

    
    
     <dt id="ini.safe-mode-exec-dir">
      <code class="parameter">safe_mode_exec_dir</code>
      <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
     </dt>

     <dd>

      <p class="para">
       Si PHP se emplea en modo seguro, <span class="function"><a href="function.system.html" class="function">system()</a></span> y las demás
       <a href="ref.exec.html" class="link">funciones que ejecuten programas del sistema</a>
       rechazarán iniciar programas que no estén en este directorio.
       Se ha de emplear <em>/</em> como separador de directorios en
       todos los entornos, incluyendo Windows.
      </p>
     </dd>

    
    
     <dt id="ini.safe-mode-allowed-env-vars">
      <code class="parameter">safe_mode_allowed_env_vars</code>
      <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
     </dt>

     <dd>

      <p class="para">
       Establecer ciertas variables de entorno podría crear una brecha potencial de seguridad.
       Esta directiva contiene una lista de prefijos separados por comas. En el modo seguro,
       el usuario podrá solamente modificar las variables de entorno cuyos nombre comiencen con los
       prefijos proporcionados aquí. Por omisión, los usuarios solamente podrán establecer
       variables de entorno que comiencen con <em>PHP_</em>
       (p.ej., <em>PHP_FOO=BAR</em>).
      </p>
      <blockquote class="note"><p><strong class="note">Nota</strong>: 
       <p class="para">
        Si esta directiva está vacía, PHP permitirá al usuario modificar CUALQUIER
        variable de entorno.
       </p>
      </p></blockquote>
     </dd>

    
    
     <dt id="ini.safe-mode-protected-env-vars">
      <code class="parameter">safe_mode_protected_env_vars</code>
      <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
     </dt>

     <dd>

      <p class="para">
       Esta directiva contiene una lista de variables de entorno separadas
       por comas que no podrá cambiar el un usuario que utilice
       <span class="function"><a href="function.putenv.html" class="function">putenv()</a></span>. Estas variables estarán protegidas
       incluso si safe_mode_allowed_env_vars está establecida para permitir cambiarlas.
      </p>
     </dd>

    
   </dl>

  </p>
  <p class="para">
   Véase también: <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a>,
   <a href="ini.core.html#ini.disable-functions" class="link">disable_functions</a>,
   <a href="ini.core.html#ini.disable-classes" class="link">disable_classes</a>,
   <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>,
   <a href="errorfunc.configuration.html#ini.display-errors" class="link">display_errors</a>, y
   <a href="errorfunc.configuration.html#ini.log-errors" class="link">log_errors</a>.
  </p>
  
  <p class="para">
   Cuando <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe_mode</a> está activado, PHP comprueba
   si el propietario del script en uso coincide con el del fichero sobre el que se va
   a operar mediante una función de ficheros o su directorio. Por ejemplo: 
   <div class="example-contents">
<div class="lscode"><pre class="lscode">-rw-rw-r--    1 rasmus   rasmus       33 Jul  1 19:20 script.php 
-rw-r--r--    1 root     root       1116 May 26 18:01 /etc/passwd</pre>
</div>
   </div>

   La ejecución de <var class="filename">script.php</var>:
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;readfile</span><span style="color: #007700">(</span><span style="color: #DD0000">'/etc/passwd'</span><span style="color: #007700">);&nbsp;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   resultará en este error cuando el modo seguro está habilitado: 
   <div class="example-contents screen">
<div class="cdata"><pre>
Warning: SAFE MODE Restriction in effect. The script whose uid is 500 is not 
allowed to access /etc/passwd owned by uid 0 in /docroot/script.php on line 2
</pre></div>
   </div>
  </p>
  <p class="para">
   Sin embargo, podrían haber entornos donde una comprobación estricta del
   <em>UID</em> no sea apropiada, siendo una comprobación del <em>GID</em>
   suficiente. El soporte para esto se realiza a través de <a href="ini.sect.safe-mode.html#ini.safe-mode-gid" class="link">safe_mode_gid</a>. Al establecerlo a
   <em>On</em> se realiza la comprobación del <em>GID</em>,
   y al establecerlo a <em>Off</em> (lo predeterminado) se realiza
   la del <em>UID</em>.
  </p>
  <p class="para">
   Si en lugar de <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe_mode</a> se establece un
   directorio de <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a>, todas
   las operaciones de ficheros estarán limitadas a ficheros que estén bajo el directorio especificado.
   Por ejemplo (ejemplo de <var class="filename">httpd.conf</var> de Apache): 
   <div class="example-contents">
<div class="inicode"><pre class="inicode">&lt;Directory /docroot&gt;
  php_admin_value open_basedir /docroot 
&lt;/Directory&gt;</pre>
</div>
   </div>

   Si se ejecuta el mismo <var class="filename">script.php</var> con esta
   configuración de <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a>,
   el resultado será este: 
   <div class="example-contents screen">
<div class="cdata"><pre>
Warning: open_basedir restriction in effect. File is in wrong directory in 
/docroot/script.php on line 2 
</pre></div>
   </div>
  </p>
  <p class="para">
   También se pueden deshabilitar funciones individuales. Observe que la
   directiva <a href="ini.core.html#ini.disable-functions" class="link">disable_functions</a>
   no se puede utilizar fuera del fichero <var class="filename">php.ini</var>, lo que significa que
   no se pueden deshabilitar funciones basándose en un host virtual o directorio
   en el fichero <var class="filename">httpd.conf</var>.
   Si se añade lo siguiente al fichero <var class="filename">php.ini</var>: 
   <div class="example-contents">
<div class="inicode"><pre class="inicode">disable_functions = readfile,system</pre>
</div>
   </div>

   se obtendrá esta salida: 
   <div class="example-contents screen">
<div class="cdata"><pre>
Warning: readfile() has been disabled for security reasons in 
/docroot/script.php on line 2 
</pre></div>
   </div>
  </p>
  <div class="warning"><strong class="warning">Advertencia</strong>
   <p class="para">
    Por supuesto, estas restricciones de PHP no son válidas para binarios en ejecución.
   </p>
  </div>
 </div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="features.safe-mode.html">Modo seguro</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="features.safe-mode.functions.html">Funciones restringidas/deshabilitadas por el modo seguro</a></div>
 <div class="up"><a href="features.safe-mode.html">Modo seguro</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
