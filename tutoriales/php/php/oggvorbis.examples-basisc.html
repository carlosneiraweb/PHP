<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Ejemplo de uso de ogg:// wrapper.</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="oggvorbis.examples.html">Ejemplos</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.openal.html">OpenAL</a></div>
 <div class="up"><a href="oggvorbis.examples.html">Ejemplos</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="oggvorbis.examples-basisc" class="section">
  <h2 class="title">Ejemplo de uso de ogg:// wrapper.</h2>
  <p class="para">
   <div class="example" id="example-681">
    <p><strong>Ejemplo #1 Leer un fichero OGG/Vorbis</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />dl</span><span style="color: #007700">(</span><span style="color: #DD0000">"oggvorbis.so"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Por&nbsp;omisión,&nbsp;ogg://&nbsp;decodificará&nbsp;a&nbsp;16&nbsp;bit&nbsp;sin&nbsp;signo&nbsp;Little&nbsp;Endian&nbsp;*/<br /></span><span style="color: #0000BB">$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'ogg://myaudio.ogg'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'r'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Recopilar&nbsp;información&nbsp;sobre&nbsp;el&nbsp;fichero.&nbsp;*/<br /></span><span style="color: #0000BB">$metadatos&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_get_meta_data</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Inspeccionar&nbsp;la&nbsp;primera&nbsp;canción&nbsp;(normalmente&nbsp;una&nbsp;única&nbsp;canción,&nbsp;<br />&nbsp;&nbsp;&nbsp;pero&nbsp;los&nbsp;ficheros&nbsp;OGG/Vorbis&nbsp;pueden&nbsp;ser&nbsp;encadenados)&nbsp;*/<br /></span><span style="color: #0000BB">$datos_canción&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$metadatos</span><span style="color: #007700">[</span><span style="color: #DD0000">'wrapper_data'</span><span style="color: #007700">][</span><span style="color: #0000BB">0</span><span style="color: #007700">];<br /><br />echo&nbsp;</span><span style="color: #DD0000">"Fichero&nbsp;OGG/Vorbis&nbsp;codificado&nbsp;por:&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$datos_canción</span><span style="color: #007700">[</span><span style="color: #DD0000">'vendor'</span><span style="color: #007700">]}</span><span style="color: #DD0000">\n."</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #DD0000">"&nbsp;&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$datos_canción</span><span style="color: #007700">[</span><span style="color: #DD0000">'channels'</span><span style="color: #007700">]}</span><span style="color: #DD0000">&nbsp;canales&nbsp;de&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$datos_canción</span><span style="color: #007700">[</span><span style="color: #DD0000">'rate'</span><span style="color: #007700">]}</span><span style="color: #DD0000">Hz&nbsp;muestreo&nbsp;codificado&nbsp;a&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$datos_canción</span><span style="color: #007700">[</span><span style="color: #DD0000">'bitrate_nominal'</span><span style="color: #007700">]}</span><span style="color: #DD0000">bps.\n"</span><span style="color: #007700">;<br />foreach(</span><span style="color: #0000BB">$datos_canción</span><span style="color: #007700">[</span><span style="color: #DD0000">'comments'</span><span style="color: #007700">]&nbsp;as&nbsp;</span><span style="color: #0000BB">$comentario</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&nbsp;&nbsp;</span><span style="color: #0000BB">$comentario</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}<br /><br />while&nbsp;(</span><span style="color: #0000BB">$audio_data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fread</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">8192</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Hacer&nbsp;algo&nbsp;con&nbsp;el&nbsp;audio&nbsp;PCM&nbsp;que&nbsp;estamos&nbsp;extrayendo&nbsp;desde&nbsp;el&nbsp;OGG.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copiarlo&nbsp;a&nbsp;/dev/dsp&nbsp;es&nbsp;un&nbsp;buen&nbsp;destino&nbsp;en&nbsp;sistemas&nbsp;linux,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recuerde&nbsp;configurar&nbsp;primero&nbsp;su&nbsp;dispositivo&nbsp;al&nbsp;modo&nbsp;de&nbsp;muestreo&nbsp;.&nbsp;*/<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  
  <p class="para">
   <div class="example" id="example-682">
    <p><strong>Ejemplo #2 Codificar un fichero de audio a OGG/Vorbis</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />dl</span><span style="color: #007700">(</span><span style="color: #DD0000">'oggvorbis.so'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$contexto&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'ogg'</span><span style="color: #007700">=&gt;array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'pcm_mode'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">OGGVORBIS_PCM_S8</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Audio&nbsp;de&nbsp;8&nbsp;bit&nbsp;con&nbsp;signo&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'rate'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">44100</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Calida&nbsp;CD&nbsp;de&nbsp;44kHz&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'bitrate'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">0.5</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;VBR&nbsp;calidad&nbsp;media*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'channels'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Mono&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'serialno'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">12345</span><span style="color: #007700">)));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;ünoco&nbsp;dentro&nbsp;de&nbsp;nuestro&nbsp;flujo&nbsp;*/<br /><br />/*&nbsp;Abrir&nbsp;un&nbsp;fichero&nbsp;para&nbsp;añadir&nbsp;información.&nbsp;Esto&nbsp;"encadenará"&nbsp;un&nbsp;segundo&nbsp;flujo&nbsp;OGG&nbsp;al&nbsp;final&nbsp;del&nbsp;primero.&nbsp;*/<br /></span><span style="color: #0000BB">$ogg&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'ogg://mysong.ogg'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'a'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$contexto</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$pcm&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysample.pcm'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'r'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Comprimir&nbsp;el&nbsp;audio&nbsp;PCM&nbsp;sin&nbsp;tratar&nbsp;de&nbsp;mysample.pcm&nbsp;a&nbsp;mysong.ogg&nbsp;*/<br /></span><span style="color: #0000BB">stream_copy_to_stream</span><span style="color: #007700">(</span><span style="color: #0000BB">$pcm</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$ogg</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$pcm</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$ogg</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="oggvorbis.examples.html">Ejemplos</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="book.openal.html">OpenAL</a></div>
 <div class="up"><a href="oggvorbis.examples.html">Ejemplos</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
