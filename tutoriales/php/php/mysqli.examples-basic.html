<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Ejemplos b&aacute;sicos de la extensi&oacute;n MySQLi</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mysqli.examples.html">Ejemplos</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="class.mysqli.html">mysqli</a></div>
 <div class="up"><a href="mysqli.examples.html">Ejemplos</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="mysqli.examples-basic" class="section">
  <h2 class="title">Ejemplos básicos de la extensión MySQLi</h2>
  <p class="para">
   Este ejemplo muestra cómo conectarse, ejecutar una consulta, utilizar un manejo de
   errores básico, imprimir filas de resultados, y desconectarse de una base de datos de MySQL.
  </p>
  <p class="para">
   Este ejemplo emplea la base de datos de libre disposición Sakila, la cual
   puede descargarse desde <a href="http://dev.mysql.com/doc/sakila/en/index.html" class="link external">&raquo;&nbsp;dev.mysql.com,
   tal como se describe aquí</a>. Para que este ejemplo funcione, (a) instalar sakila 
   y (b) modificar las variables de conexión (host, tu_usuario, tu_contraseña).
  </p>
  <div class="example" id="example-1867">
   <p><strong>Ejemplo #1 Ejemplo resumen de la extensión MySQLi</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Vamos&nbsp;a&nbsp;pasar&nbsp;una&nbsp;variable&nbsp;$_GET&nbsp;a&nbsp;nuestro&nbsp;ejemplo,&nbsp;en&nbsp;este&nbsp;caso&nbsp;es<br />//&nbsp;'aid'&nbsp;para&nbsp;'actor_id'&nbsp;de&nbsp;nuestra&nbsp;base&nbsp;de&nbsp;datos&nbsp;Sakila.&nbsp;Le&nbsp;vamos&nbsp;a&nbsp;asignar&nbsp;un<br />//&nbsp;valor&nbsp;predeterminado&nbsp;de&nbsp;1,&nbsp;y&nbsp;a&nbsp;amoldarla&nbsp;a&nbsp;un&nbsp;integer&nbsp;para&nbsp;evitar&nbsp;inyecciones<br />//&nbsp;de&nbsp;SQL&nbsp;y/o&nbsp;problemas&nbsp;de&nbsp;seguridad&nbsp;relacionados.&nbsp;El&nbsp;manejo&nbsp;de&nbsp;todo&nbsp;esto&nbsp;va&nbsp;más<br />//&nbsp;allá&nbsp;del&nbsp;alcance&nbsp;de&nbsp;este&nbsp;sencillo&nbsp;ejemplo:<br />//&nbsp;&nbsp;&nbsp;http://example.org/script.php?aid=42<br /></span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'aid'</span><span style="color: #007700">])&nbsp;&amp;&amp;&nbsp;</span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'aid'</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$aid&nbsp;</span><span style="color: #007700">=&nbsp;(int)&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'aid'</span><span style="color: #007700">];<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$aid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Conectarse&nbsp;a&nbsp;y&nbsp;seleccionar&nbsp;una&nbsp;base&nbsp;de&nbsp;datos&nbsp;de&nbsp;MySQL&nbsp;llamada&nbsp;sakila<br />//&nbsp;Nombre&nbsp;de&nbsp;host:&nbsp;127.0.0.1,&nbsp;nombre&nbsp;de&nbsp;usuario:&nbsp;tu_usuario,&nbsp;contraseña:&nbsp;tu_contraseña,&nbsp;bd:&nbsp;sakila<br /></span><span style="color: #0000BB">$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">'127.0.0.1'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'tu_usuario'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'tu_contraseña'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sakila'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;¡Oh,&nbsp;no!&nbsp;Existe&nbsp;un&nbsp;error&nbsp;'connect_errno',&nbsp;fallando&nbsp;así&nbsp;el&nbsp;intento&nbsp;de&nbsp;conexión<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;La&nbsp;conexión&nbsp;falló.&nbsp;¿Que&nbsp;vamos&nbsp;a&nbsp;hacer?&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Se&nbsp;podría&nbsp;contactar&nbsp;con&nbsp;uno&nbsp;mismo&nbsp;(¿email?),&nbsp;registrar&nbsp;el&nbsp;error,&nbsp;mostrar&nbsp;una&nbsp;bonita&nbsp;página,&nbsp;etc.<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;No&nbsp;se&nbsp;debe&nbsp;revelar&nbsp;información&nbsp;delicada<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Probemos&nbsp;esto:<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Lo&nbsp;sentimos,&nbsp;este&nbsp;sitio&nbsp;web&nbsp;está&nbsp;experimentando&nbsp;problemas."</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Algo&nbsp;que&nbsp;no&nbsp;se&nbsp;debería&nbsp;de&nbsp;hacer&nbsp;en&nbsp;un&nbsp;sitio&nbsp;público,&nbsp;aunque&nbsp;este&nbsp;ejemplo&nbsp;lo&nbsp;mostrará<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;de&nbsp;todas&nbsp;formas,&nbsp;es&nbsp;imprimir&nbsp;información&nbsp;relacionada&nbsp;con&nbsp;errores&nbsp;de&nbsp;MySQL&nbsp;--&nbsp;se&nbsp;podría&nbsp;registrar<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;Fallo&nbsp;al&nbsp;conectarse&nbsp;a&nbsp;MySQL&nbsp;debido&nbsp;a:&nbsp;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Errno:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_errno&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect_error&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Podría&nbsp;ser&nbsp;conveniente&nbsp;mostrar&nbsp;algo&nbsp;interesante,&nbsp;aunque&nbsp;nosotros&nbsp;simplemente&nbsp;saldremos<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Realizar&nbsp;una&nbsp;consulta&nbsp;SQL<br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;actor_id,&nbsp;first_name,&nbsp;last_name&nbsp;FROM&nbsp;actor&nbsp;WHERE&nbsp;actor_id&nbsp;=&nbsp;</span><span style="color: #0000BB">$aid</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />if&nbsp;(!</span><span style="color: #0000BB">$resultado&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;¡Oh,&nbsp;no!&nbsp;La&nbsp;consulta&nbsp;falló.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Lo&nbsp;sentimos,&nbsp;este&nbsp;sitio&nbsp;web&nbsp;está&nbsp;experimentando&nbsp;problemas."</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;De&nbsp;nuevo,&nbsp;no&nbsp;hacer&nbsp;esto&nbsp;en&nbsp;un&nbsp;sitio&nbsp;público,&nbsp;aunque&nbsp;nosotros&nbsp;mostraremos<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;cómo&nbsp;obtener&nbsp;información&nbsp;del&nbsp;error<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;La&nbsp;ejecución&nbsp;de&nbsp;la&nbsp;consulta&nbsp;falló&nbsp;debido&nbsp;a:&nbsp;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Query:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Errno:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errno&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Error:&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;¡Uf,&nbsp;lo&nbsp;conseguimos!.&nbsp;Sabemos&nbsp;que&nbsp;nuestra&nbsp;conexión&nbsp;a&nbsp;MySQL&nbsp;y&nbsp;nuestra&nbsp;consulta<br />//&nbsp;tuvieron&nbsp;éxito,&nbsp;pero&nbsp;¿tenemos&nbsp;un&nbsp;resultado?<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$resultado</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">num_rows&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;¡Oh,&nbsp;no&nbsp;ha&nbsp;filas!&nbsp;Unas&nbsp;veces&nbsp;es&nbsp;lo&nbsp;previsto,&nbsp;pero&nbsp;otras<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;no.&nbsp;Nosotros&nbsp;decidimos.&nbsp;En&nbsp;este&nbsp;caso,&nbsp;¿podría&nbsp;haber&nbsp;sido<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;actor_id&nbsp;demasiado&nbsp;grande?&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"Lo&nbsp;sentimos.&nbsp;No&nbsp;se&nbsp;pudo&nbsp;encontrar&nbsp;una&nbsp;coincidencia&nbsp;para&nbsp;el&nbsp;ID&nbsp;</span><span style="color: #0000BB">$aid</span><span style="color: #DD0000">.&nbsp;Inténtelo&nbsp;de&nbsp;nuevo."</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Ahora,&nbsp;sabemos&nbsp;que&nbsp;existe&nbsp;solamente&nbsp;un&nbsp;único&nbsp;resultado&nbsp;en&nbsp;este&nbsp;ejemplo,&nbsp;por&nbsp;lo<br />//&nbsp;que&nbsp;vamos&nbsp;a&nbsp;colocarlo&nbsp;en&nbsp;un&nbsp;array&nbsp;asociativo&nbsp;donde&nbsp;las&nbsp;claves&nbsp;del&nbsp;mismo&nbsp;son&nbsp;los<br />//&nbsp;nombres&nbsp;de&nbsp;las&nbsp;columnas&nbsp;de&nbsp;la&nbsp;tabla<br /></span><span style="color: #0000BB">$actor&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$resultado</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #DD0000">"A&nbsp;veces&nbsp;veo&nbsp;a&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'first_name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'last_name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"&nbsp;en&nbsp;la&nbsp;TV."</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;Ahora,&nbsp;vamor&nbsp;a&nbsp;obtener&nbsp;cinco&nbsp;actores&nbsp;aleatorios&nbsp;y&nbsp;a&nbsp;imprimir&nbsp;sus&nbsp;nombres&nbsp;en&nbsp;una&nbsp;lista.<br />//&nbsp;El&nbsp;manejo&nbsp;de&nbsp;errores&nbsp;va&nbsp;a&nbsp;ser&nbsp;menor&nbsp;aquí,&nbsp;aunque&nbsp;ya&nbsp;sabemos&nbsp;como&nbsp;hacerlo<br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;actor_id,&nbsp;first_name,&nbsp;last_name&nbsp;FROM&nbsp;actor&nbsp;ORDER&nbsp;BY&nbsp;rand()&nbsp;LIMIT&nbsp;5"</span><span style="color: #007700">;<br />if&nbsp;(!</span><span style="color: #0000BB">$resultado&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Lo&nbsp;sentimos,&nbsp;este&nbsp;sitio&nbsp;web&nbsp;está&nbsp;experimentando&nbsp;problemas."</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Imprimir&nbsp;nuestros&nbsp;cinco&nbsp;actores&nbsp;aleatorios&nbsp;en&nbsp;una&nbsp;lista,&nbsp;y&nbsp;enlazar&nbsp;cada&nbsp;uno<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"&lt;ul&gt;\n"</span><span style="color: #007700">;<br />while&nbsp;(</span><span style="color: #0000BB">$actor&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$resultado</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_assoc</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;li&gt;&lt;a&nbsp;href='"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'SCRIPT_FILENAME'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"?aid="&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'actor_id'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">"'&gt;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'first_name'</span><span style="color: #007700">]&nbsp;.&nbsp;</span><span style="color: #DD0000">'&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$actor</span><span style="color: #007700">[</span><span style="color: #DD0000">'last_name'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;/a&gt;&lt;/li&gt;\n"</span><span style="color: #007700">;<br />}<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;/ul&gt;\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;El&nbsp;script&nbsp;automáticamente&nbsp;liberará&nbsp;el&nbsp;resultado&nbsp;y&nbsp;cerrará&nbsp;la&nbsp;conexión<br />//&nbsp;a&nbsp;MySQL&nbsp;cuando&nbsp;finalice,&nbsp;aunque&nbsp;aquí&nbsp;lo&nbsp;vamos&nbsp;a&nbsp;hacer&nbsp;nostros&nbsp;mismos<br /></span><span style="color: #0000BB">$resultado</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">free</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mysqli.examples.html">Ejemplos</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="class.mysqli.html">mysqli</a></div>
 <div class="up"><a href="mysqli.examples.html">Ejemplos</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
